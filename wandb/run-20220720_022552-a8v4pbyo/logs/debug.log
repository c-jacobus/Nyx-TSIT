2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_setup.py:_flush():75] Loading settings from /global/homes/c/cjacobus/.config/wandb/settings
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_setup.py:_flush():75] Loading settings from /global/u1/c/cjacobus/Nyx-TSIT/wandb/settings
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_setup.py:_flush():75] Loading settings from environment variables: {'start_method': 'thread'}
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_setup.py:_flush():75] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program': 'train.py'}
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_init.py:_log_setup():438] Logging user logs to /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/logs/debug.log
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_init.py:_log_setup():439] Logging internal logs to /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/logs/debug-internal.log
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_init.py:init():472] calling init triggers
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_init.py:init():475] wandb.init called with sweep_config: {}
config: {'num_data_workers': 16, 'in_channels': [0, 1, 2, 3, 17, 18, 19], 'out_channels': [0], 'min_path': '/pscratch/sd/s/shas1693/data/era5/mins.npy', 'max_path': '/pscratch/sd/s/shas1693/data/era5/maxs.npy', 'time_means_path': '/pscratch/sd/s/shas1693/data/era5/time_means.npy', 'global_means_path': '/pscratch/sd/s/shas1693/data/era5/global_means.npy', 'global_stds_path': '/pscratch/sd/s/shas1693/data/era5/global_stds.npy', 'precip': '/pscratch/sd/p/pharring/ERA5/precip/total_precipitation', 'precip_eps': 1e-05, 'dt': 1, 'n_history': 0, 'crop_size_x': None, 'crop_size_y': None, 'roll': False, 'conttime': False, 'normalization': 'zscore', 'add_grid': False, 'model': 'pix2pix', 'norm_G': 'spectralfadebatch3x3', 'norm_D': 'spectralinstance', 'norm_S': 'spectralinstance', 'norm_E': 'spectralinstance', 'batch_size': 16, 'img_size': [512, 512, 512], 'box_size': [512, 512, 512], 'data_size': 128, 'input_nc': 5, 'output_nc': 5, 'netG': 'tsit', 'ngf': 64, 'init_type': 'xavier', 'init_variance': 0.02, 'z_dim': 256, 'alpha': 1.0, 'no_ss': True, 'downsamp': True, 'num_upsampling_blocks': 6, 'use_periodic_padding': True, 'additive_noise': False, 'nef': 16, 'use_vae': False, 'niter': 20, 'niter_decay': 20, 'optimizer': 'adam', 'beta1': 0.5, 'beta2': 0.999, 'lr': 0.0002, 'D_steps_per_G': 1, 'use_spec_loss': False, 'lambda_spec': 1.0, 'use_l1_loss': False, 'lambda_l1': 1.0, 'ndf': 64, 'lambda_feat': 0.5, 'no_ganFeat_loss': False, 'gan_mode': 'hinge', 'netD': 'multiscale', 'num_D': 2, 'n_layers_D': 4, 'no_TTUR': True, 'lambda_kld': 0.05, 'cat_inp': False, 'entity': 'weatherbenching', 'project': 'Nyx-TSIT', 'log_to_wandb': True, 'log_to_screen': True, 'save_checkpoint': True, 'weight_init': ordereddict([('conv_init', 'normal'), ('conv_scale', 0.02), ('conv_bias', 0.0)]), 'lambda_rho': 0, 'full_scale': True, 'global_batch_size': 64, 'base_batch_size': 64, 'Nsamples': 4096, 'Nsamples_val': 128, 'num_epochs': 60, 'enable_amp': False, 'enable_apex': False, 'enable_benchy': False, 'enable_jit': False, 'expdir': '/logs', 'lr_schedule': ordereddict([('scaling', 'sqrt'), ('start_lr', 0.0002), ('end_lr', 0.0), ('warmup_steps', 128)]), 'data_loader_config': 'lowmem', 'N_out_channels': 5, 'N_in_channels': 5, 'train_path': '/pscratch/sd/c/cjacobus/Nyx_512/train_s1_512_hydro.h5', 'val_path': '/pscratch/sd/c/cjacobus/Nyx_512/train_s1_512_hydro.h5', 'use_cache': None}
2022-07-20 02:25:52,213 INFO    MainThread:82436 [wandb_init.py:init():525] starting backend
2022-07-20 02:25:52,217 INFO    MainThread:82436 [backend.py:ensure_launched():219] starting backend process...
2022-07-20 02:25:52,217 INFO    MainThread:82436 [backend.py:ensure_launched():224] started backend process with pid: 0
2022-07-20 02:25:52,217 INFO    MainThread:82436 [wandb_init.py:init():534] backend started and connected
2022-07-20 02:25:52,218 INFO    BackendThr:82436 [internal.py:wandb_internal():92] W&B internal server running at pid: 82436, started at: 2022-07-20 02:25:52.217606
2022-07-20 02:25:52,223 INFO    MainThread:82436 [wandb_init.py:init():598] updated telemetry
2022-07-20 02:25:52,224 INFO    WriterThread:82436 [datastore.py:open_for_write():77] open: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/run-a8v4pbyo.wandb
2022-07-20 02:25:52,236 INFO    MainThread:82436 [wandb_init.py:init():629] communicating run to backend with 30 second timeout
2022-07-20 02:25:52,491 INFO    MainThread:82436 [wandb_run.py:_on_init():1922] communicating current version
2022-07-20 02:25:52,495 INFO    SenderThread:82436 [dir_watcher.py:__init__():169] watching files in: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files
2022-07-20 02:25:52,495 INFO    SenderThread:82436 [sender.py:_start_run_threads():812] run started: a8v4pbyo with start time 1658283952
2022-07-20 02:25:52,495 INFO    SenderThread:82436 [sender.py:_save_file():947] saving file wandb-summary.json with policy end
2022-07-20 02:25:52,524 INFO    MainThread:82436 [wandb_run.py:_on_init():1926] got version response upgrade_message: "wandb version 0.12.21 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2022-07-20 02:25:52,524 INFO    MainThread:82436 [wandb_init.py:init():660] starting run threads in backend
2022-07-20 02:25:53,124 INFO    SenderThread:82436 [sender.py:_save_file():947] saving file wandb-metadata.json with policy now
2022-07-20 02:25:53,132 INFO    MainThread:82436 [wandb_run.py:_console_start():1896] atexit reg
2022-07-20 02:25:53,135 INFO    MainThread:82436 [wandb_run.py:_redirect():1769] redirect: SettingsConsole.WRAP
2022-07-20 02:25:53,135 INFO    MainThread:82436 [wandb_run.py:_redirect():1806] Wrapping output streams.
2022-07-20 02:25:53,136 INFO    MainThread:82436 [wandb_run.py:_redirect():1830] Redirects installed.
2022-07-20 02:25:53,136 INFO    MainThread:82436 [wandb_init.py:init():685] run started, returning control to user process
2022-07-20 02:25:53,496 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_created():217] file/dir created: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/wandb-metadata.json
2022-07-20 02:25:53,497 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_created():217] file/dir created: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/requirements.txt
2022-07-20 02:25:53,497 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_created():217] file/dir created: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/conda-environment.yaml
2022-07-20 02:25:53,497 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_created():217] file/dir created: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:25:53,497 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_created():217] file/dir created: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/wandb-summary.json
2022-07-20 02:25:53,559 INFO    Thread-14 :82436 [upload_job.py:push():137] Uploaded file /tmp/tmp6hf567quwandb/3h6955j5-wandb-metadata.json
2022-07-20 02:25:55,496 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:26:01,499 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:26:11,502 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:26:13,503 INFO    Thread-10 :82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:26:14,438 INFO    MainThread:82436 [wandb_run.py:_finish():1684] finishing run weatherbenching/Nyx-TSIT/a8v4pbyo
2022-07-20 02:26:14,438 INFO    MainThread:82436 [wandb_run.py:_atexit_cleanup():1865] got exitcode: 0
2022-07-20 02:26:14,439 INFO    MainThread:82436 [wandb_run.py:_restore():1837] restore
2022-07-20 02:26:15,171 INFO    SenderThread:82436 [sender.py:send_exit():371] handling exit code: 0
2022-07-20 02:26:15,171 INFO    SenderThread:82436 [sender.py:send_exit():373] handling runtime: 22
2022-07-20 02:26:15,171 INFO    SenderThread:82436 [sender.py:_save_file():947] saving file wandb-summary.json with policy end
2022-07-20 02:26:15,171 INFO    SenderThread:82436 [sender.py:send_exit():379] send defer
2022-07-20 02:26:15,172 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 0
2022-07-20 02:26:15,172 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 0
2022-07-20 02:26:15,172 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 1
2022-07-20 02:26:15,172 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 796
  total_bytes: 796
}

2022-07-20 02:26:15,173 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 1
2022-07-20 02:26:15,242 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 1
2022-07-20 02:26:15,242 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 2
2022-07-20 02:26:15,242 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 2
2022-07-20 02:26:15,242 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 2
2022-07-20 02:26:15,242 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 3
2022-07-20 02:26:15,243 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 3
2022-07-20 02:26:15,243 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 3
2022-07-20 02:26:15,243 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 4
2022-07-20 02:26:15,243 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 4
2022-07-20 02:26:15,243 INFO    SenderThread:82436 [sender.py:_save_file():947] saving file wandb-summary.json with policy end
2022-07-20 02:26:15,244 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 4
2022-07-20 02:26:15,244 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 5
2022-07-20 02:26:15,244 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 5
2022-07-20 02:26:15,244 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 5
2022-07-20 02:26:15,431 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 6
2022-07-20 02:26:15,431 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 6
2022-07-20 02:26:15,432 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 796
  total_bytes: 796
}

2022-07-20 02:26:15,432 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 6
2022-07-20 02:26:15,432 INFO    SenderThread:82436 [dir_watcher.py:finish():283] shutting down directory watcher
2022-07-20 02:26:15,504 INFO    SenderThread:82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/config.yaml
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:_on_file_modified():230] file/dir modified: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/wandb-summary.json
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:finish():313] scan: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:finish():327] scan save: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/conda-environment.yaml conda-environment.yaml
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:finish():327] scan save: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/wandb-metadata.json wandb-metadata.json
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:finish():327] scan save: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/config.yaml config.yaml
2022-07-20 02:26:15,505 INFO    SenderThread:82436 [dir_watcher.py:finish():327] scan save: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/requirements.txt requirements.txt
2022-07-20 02:26:15,506 INFO    SenderThread:82436 [dir_watcher.py:finish():327] scan save: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/wandb-summary.json wandb-summary.json
2022-07-20 02:26:15,509 INFO    SenderThread:82436 [dir_watcher.py:finish():327] scan save: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log output.log
2022-07-20 02:26:15,513 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 7
2022-07-20 02:26:15,516 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 7
2022-07-20 02:26:15,517 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 7
2022-07-20 02:26:15,520 INFO    SenderThread:82436 [file_pusher.py:finish():145] shutting down file pusher
2022-07-20 02:26:15,533 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 796
  total_bytes: 11155
}

2022-07-20 02:26:15,634 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 796
  total_bytes: 11155
}

2022-07-20 02:26:15,735 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}

2022-07-20 02:26:15,836 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}

2022-07-20 02:26:15,929 INFO    Thread-22 :82436 [upload_job.py:push():137] Uploaded file /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/requirements.txt
2022-07-20 02:26:15,936 INFO    Thread-21 :82436 [upload_job.py:push():137] Uploaded file /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/config.yaml
2022-07-20 02:26:15,939 INFO    Thread-24 :82436 [upload_job.py:push():137] Uploaded file /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/output.log
2022-07-20 02:26:15,939 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}

2022-07-20 02:26:15,956 INFO    Thread-23 :82436 [upload_job.py:push():137] Uploaded file /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/files/wandb-summary.json
2022-07-20 02:26:16,040 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}

2022-07-20 02:26:16,142 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}

2022-07-20 02:26:16,156 INFO    Thread-9  :82436 [sender.py:transition_state():392] send defer: 8
2022-07-20 02:26:16,157 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 8
2022-07-20 02:26:16,157 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 8
2022-07-20 02:26:16,464 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 9
2022-07-20 02:26:16,465 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 9
2022-07-20 02:26:16,465 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}

2022-07-20 02:26:16,465 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 9
2022-07-20 02:26:16,465 INFO    SenderThread:82436 [sender.py:transition_state():392] send defer: 10
2022-07-20 02:26:16,466 INFO    HandlerThread:82436 [handler.py:handle_request_defer():164] handle defer: 10
2022-07-20 02:26:16,466 INFO    SenderThread:82436 [sender.py:send_request_defer():388] handle sender defer: 10
2022-07-20 02:26:16,566 INFO    SenderThread:82436 [file_pusher.py:join():150] waiting for file pusher
2022-07-20 02:26:16,816 INFO    MainThread:82436 [wandb_run.py:_on_finish():1995] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 11155
  total_bytes: 11155
}
local_info {
}

2022-07-20 02:26:16,918 INFO    HandlerThread:82436 [handler.py:finish():790] shutting down handler
2022-07-20 02:26:17,466 INFO    WriterThread:82436 [datastore.py:close():281] close: /global/u1/c/cjacobus/Nyx-TSIT/wandb/run-20220720_022552-a8v4pbyo/run-a8v4pbyo.wandb
2022-07-20 02:26:17,816 INFO    SenderThread:82436 [sender.py:finish():1107] shutting down sender
2022-07-20 02:26:17,816 INFO    SenderThread:82436 [file_pusher.py:finish():145] shutting down file pusher
2022-07-20 02:26:17,816 INFO    SenderThread:82436 [file_pusher.py:join():150] waiting for file pusher
2022-07-20 02:26:17,919 INFO    MainThread:82436 [wandb_run.py:_footer_history_summary_info():3087] rendering history
2022-07-20 02:26:17,919 INFO    MainThread:82436 [wandb_run.py:_footer_history_summary_info():3116] rendering summary
2022-07-20 02:26:17,921 INFO    MainThread:82436 [wandb_run.py:_footer_sync_info():3044] logging synced files
